#!/usr/bin/env python

import sys

from driver import *

regs = regs[2]

args = [int(arg, 0) for arg in sys.argv[1:]]

dev  = args[0] & 3
addr = args[1] & 0xFFF

command = (dev << 29) | (addr << 8)

if len(args) == 2:
    # Read
    regs[0] = command | 0x80000000
    data = regs[0]
    print '%d %03X => %02X (%d)' % (dev, addr, data, data)
elif len(args) == 3:
    # Write
    data = args[2] & 0xFF
    regs[0] = command | data
    # Readback to ensure write has completed
    resp = regs[0]
else:
    assert False
